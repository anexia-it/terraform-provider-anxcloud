---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "anxcloud_virtual_server Resource - terraform-provider-anxcloud"
subcategory: ""
description: |-
  The virtual_server resource allows you to configure and run virtual machines.
---

# anxcloud_virtual_server (Resource)

The virtual_server resource allows you to configure and run virtual machines.

### Known limitations
- removal of disks not supported
- removal of networks not supported

## Example Usage

```terraform
data "anxcloud_core_location" "anx04" {
  code = "ANX04"
}

resource "anxcloud_vlan" "example" {
  location_id          = data.anxcloud_core_location.anx04.id
  vm_provisioning      = true
  description_customer = "example-terraform"
}

resource "anxcloud_network_prefix" "v4" {
  vlan_id              = anxcloud_vlan.example.id
  location_id          = data.anxcloud_core_location.anx04.id
  ip_version           = 4
  netmask              = 30
  description_customer = "example-terraform"
}

resource "anxcloud_network_prefix" "v6" {
  vlan_id              = anxcloud_vlan.example.id
  location_id          = data.anxcloud_core_location.anx04.id
  ip_version           = 6
  netmask              = 126
  description_customer = "example-terraform"
}

resource "anxcloud_ip_address" "v4" {
  address           = cidrhost(anxcloud_network_prefix.v4.cidr, 2)
  network_prefix_id = anxcloud_network_prefix.v4.id
}

resource "anxcloud_ip_address" "v6" {
  address           = cidrhost(anxcloud_network_prefix.v6.cidr, 2)
  network_prefix_id = anxcloud_network_prefix.v6.id
}

data "anxcloud_virtual_server_template" "debian11" {
  name     = "Debian 11"
  location = data.anxcloud_core_location.anx04.id
}

resource "anxcloud_virtual_server" "example" {
  hostname    = "example-terraform"
  location_id = data.anxcloud_core_location.anx04.id
  template_id = data.anxcloud_virtual_server_template.debian11.id

  cpus   = 4
  memory = 4096

  ssh_key = file("~/.ssh/id_rsa.pub")

  # define bootstrap script
  # e.g. install software
  script = <<-EOT
    #!/bin/bash

    # install nginx server
    apt update && apt install -y nginx
    EOT

  # Set network interface
  network {
    vlan_id  = anxcloud_vlan.example.id
    ips      = [anxcloud_ip_address.v4.address, anxcloud_ip_address.v6.address]
    nic_type = "vmxnet3"
  }

  # Disk 1
  disk {
    disk_gb   = 100
    disk_type = "STD1"
  }

  # Disk 2
  disk {
    disk_gb   = 200
    disk_type = "STD1"
  }

  dns = ["8.8.8.8"]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cpus` (Number) Number of CPUs
- `hostname` (String) Virtual server hostname
- `location_id` (String) Location identifier
- `memory` (Number) Memory in MB.
- `template_id` (String) Template identifier

### Optional

- `boot_delay` (Number) Boot delay in seconds. Example: (0, 1, …).
- `cpu_performance_type` (String) CPU type. Example: (`best-effort`, `standard`, `enterprise`, `performance`), defaults to `standard`.
- `critical_operation_confirmed` (Boolean) Confirms a critical operation (if needed). Potentially dangerous operations (e.g. resulting in data loss) require an additional confirmation. The parameter is used for VM UPDATE requests.
- `disk` (Block List) Virtual Server Disk. (see [below for nested schema](#nestedblock--disk))
- `dns` (List of String) DNS configuration. Maximum items 4. Defaults to template settings.
- `enter_bios_setup` (Boolean) Start the VM into BIOS setup on next boot.
- `force_restart_if_needed` (Boolean) Certain operations may only be performed in powered off state. Such as: shrinking memory, shrinking/adding CPU, removing disk and scaling a disk beyond 2 GB. Passing this value as true will always execute a power off and reboot request after completing all other operations. Without this flag set to true scaling operations requiring a reboot will fail.
- `network` (Block List) Network interface. (see [below for nested schema](#nestedblock--network))
- `password` (String, Sensitive) Plaintext password. Example: ('!anx123mySuperStrongPassword123anx!', 'go3ju0la1ro3', …). For systems that support it, we strongly recommend using a SSH key instead.
- `script` (String) Script to be executed after provisioning. Consider the corresponding shebang at the beginning of your script. If you want to use PowerShell, the first line should be: #ps1_sysnative.
- `sockets` (Number) Amount of CPU sockets Number of cores have to be a multiple of sockets, as they will be spread evenly across all sockets. Defaults to number of cores, i.e. one socket per CPU core.
- `ssh_key` (String, Sensitive) Public key (instead of password, only for Linux systems). Recommended over providing a plaintext password.
- `tags` (Set of String) Set of tags attached to the resource
- `template_type` (String) OS template type

### Read-Only

- `id` (String) Virtual server identifier

<a id="nestedblock--disk"></a>
### Nested Schema for `disk`

Required:

- `disk_gb` (Number) Disk capacity in GB.
- `disk_type` (String) Disk category (limits disk performance, e.g. IOPS).

Read-Only:

- `disk_id` (Number) Device identifier of the disk.


<a id="nestedblock--network"></a>
### Nested Schema for `network`

Required:

- `nic_type` (String) Network interface card type.
- `vlan_id` (String) VLAN identifier.

Optional:

- `ips` (List of String) List of IP addresses and identifiers to be assigned and configured.


